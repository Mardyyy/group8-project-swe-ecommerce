{% extends 'layout.html' %}

{% block content %}
  <div class="container mt-4">
    <h1>Edit Product</h1>

    <form method="POST">
        {{ form.hidden_tag() }}

        <div class="form-group">
          <label for="name">Product Name</label>
          {{ form.name(class="form-control") }}
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          {{ form.description(class="form-control") }}
        </div>

        <div class="form-group">
          <label for="price">Price</label>
          {{ form.price(class="form-control") }}
        </div>

        <div class="form-group">
          <label for="quantity">Quantity</label>
          {{ form.quantity(class="form-control") }}
        </div>

        <div class="form-group">
            <label for="image_url">Image URL</label>
            {{ form.image_url(class="form-control", id="image_url_input") }}
        </div>

        <div class="mb-3">
            <label>Image Preview:</label><br>
            <img id="image_preview" src="" alt="Image Preview" style="max-width: 200px; display: none;">
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-primary">Apply Changes</button>
        </div>
    </form>

    <script>
      const imageInput = document.getElementById('image_url_input');
      const previewImage = document.getElementById('image_preview');

      imageInput.addEventListener('input', function() {
          const url = this.value;
          if (url) {
              previewImage.src = url;
              previewImage.style.display = 'block';
          } else {
              previewImage.style.display = 'none';
          }
      });

      // If image fails to load, hide the preview
      previewImage.onerror = function() {
          this.style.display = 'none';
      };
    </script>
  </div>
{% endblock %}